# Mock Service Worker Setup for LibreChat

## Quick Start (No Backend Required!)

Follow these steps to run the LibreChat UI with mock data - no backend server needed.

### 1. Install Dependencies

```bash
cd client
npm install
# or
pnpm install
```

### 2. Initialize MSW Service Worker

This generates the `mockServiceWorker.js` file needed for MSW to intercept requests:

```bash
npx msw init ./public --save
```

### 3. Enable Mock Mode

Create a `.env.local` file in the **root** of the project (same level as `package.json`):

```bash
# From the project root
echo "VITE_USE_MOCKS=true" > .env.local
```

Or manually create the file with:

```
VITE_USE_MOCKS=true
```

### 4. Start the Development Server

```bash
cd client
npm run dev
```

The application will start on `http://localhost:3090` (or configured PORT).

### 5. Open the Application

Navigate to `http://localhost:3090` in your browser.

You should see:
- Mock mode indicator in the footer: "Running in mock mode - No backend required"
- MSW logs in the browser console showing intercepted requests
- Fully functional UI with sample conversations and messages

## Login

In mock mode, **any credentials will work**. For example:
- Email: `demo@example.com`
- Password: `any-password`

## What's Mocked?

âœ… **Full API Coverage:**
- Authentication (login, logout, register)
- Configuration (startup config, endpoints, models)
- Conversations (list, create, update, delete, archive)
- Messages (list, send, update)
- Chat streaming (SSE)
- File uploads
- Presets
- Tags
- User profile

âœ… **Realistic Behavior:**
- Network delays (50-500ms)
- Streaming chat responses
- Pagination support
- Error scenarios

## Customizing Mock Data

Edit files in `client/src/mocks/data/` to customize:

- `mockStartupConfig.ts` - App configuration
- `mockEndpoints.ts` - Available endpoints
- `mockModels.ts` - AI models
- `mockUser.ts` - User data
- `mockConversations.ts` - Sample conversations
- `mockMessages.ts` - Sample messages
- `mockPresets.ts` - Conversation presets

## Troubleshooting

### Service Worker Not Registering

**Problem:** MSW not intercepting requests

**Solution:**
```bash
# Re-initialize the service worker
cd client
npx msw init ./public --save

# Clear browser cache and reload
```

### Environment Variable Not Working

**Problem:** `.env.local` not being read

**Solution:**
- Ensure the file is in the **project root** (not in `client/`)
- Restart the development server
- Check that the file contains: `VITE_USE_MOCKS=true`

### Console Errors About MSW

**Problem:** `Cannot find module 'msw'`

**Solution:**
```bash
cd client
npm install msw --save-dev
```

### No Logs in Console

**Problem:** MSW is running but not logging

**Solution:**
- Open Browser DevTools Console
- Look for `[MSW]` prefixed messages
- Check Network tab for intercepted requests

## Switching Back to Real Backend

To disable mock mode and use the real backend:

**Option 1:** Remove the environment variable
```bash
# Delete .env.local or remove VITE_USE_MOCKS
```

**Option 2:** Set to false
```bash
# In .env.local
VITE_USE_MOCKS=false
```

Then restart the dev server.

## Production Builds

Mock mode is automatically **disabled** in production builds, regardless of environment variables.

## File Structure

```
LibreChat/
â”œâ”€â”€ .env.local (create this with VITE_USE_MOCKS=true)
â”œâ”€â”€ client/
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â””â”€â”€ mockServiceWorker.js (generated by MSW)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ mocks/
â”‚   â”‚   â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mockStartupConfig.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mockEndpoints.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mockModels.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mockUser.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mockConversations.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mockMessages.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ mockPresets.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ handlers.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ browser.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”‚   â””â”€â”€ main.jsx (MSW integration)
â”‚   â””â”€â”€ package.json (MSW added to devDependencies)
â””â”€â”€ MOCK_SETUP.md (this file)
```

## Next Steps

1. **Explore the UI** - All features work with mock data
2. **Customize Data** - Modify mock files to suit your needs
3. **Develop Features** - Build new UI features without backend
4. **Test Scenarios** - Simulate different API responses
5. **Demo Mode** - Show the UI without backend setup

## Need Help?

- Check `client/src/mocks/README.md` for detailed documentation
- Review the handlers in `client/src/mocks/handlers.ts`
- Examine mock data in `client/src/mocks/data/`

Happy mocking! ðŸŽ­
